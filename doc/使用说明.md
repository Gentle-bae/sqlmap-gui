# SQLMap GUI V1.0 - 详细使用说明

## 📋 快速开始

### 1. 环境准备

确保已安装以下软件和库：

- **Python 3.6+** - [官方下载](https://www.python.org/downloads/)
  - Windows：安装时勾选"Add Python to PATH"和"tcl/tk"
  - Linux/Mac：通常已预装
- **sqlmap** - 本项目已集成
- **requests库** - 自动安装或手动：`pip install requests`
- **Flask库** - 可选，用于内置靶场：`pip install flask`

### 2. 快速安装

```bash
# 方式一：一键安装依赖
pip install requests flask

# 方式二：使用国内源（推荐，速度快）
pip install -i https://pypi.tsinghua.edu.cn/simple requests flask
```

### 3. 文件结构

```
sqlmap-gui/
├── sqlmap-gui.py              # GUI主程序
├── start_gui.bat              # Windows启动脚本
├── start_gui.sh               # Linux/Mac启动脚本
├── test_sqli_server.py        # 测试靶场服务器
├── start_test_server.bat      # Windows靶场启动脚本
├── start_test_server.sh       # Linux/Mac靶场启动脚本
├── sqlmap.py                  # SQLMap主程序
├── README.md                  # 项目说明
└── doc/
    ├── 使用说明.md            # 本文件
    ├── 项目交付清单.md        # 交付清单
    └── ...
```

### 4. 启动应用

#### Windows 用户

**方式一：图形化启动（推荐）**

1. 在文件浏览器中进入项目目录
2. 双击 `start_gui.bat` 文件
3. GUI窗口即会打开

**方式二：命令行启动**

```cmd
# 打开命令提示符或PowerShell
cd 项目目录（sqlmap-gui所在文件夹）

# 运行GUI
python sqlmap-gui.py

# 或
python .\sqlmap-gui.py
```

#### Linux/Mac 用户

```bash
# 1. 进入项目目录
cd 项目目录（sqlmap-gui所在文件夹）

# 2. 赋予执行权限（首次运行）
chmod +x start_gui.sh

# 3. 启动GUI
bash start_gui.sh

# 或直接用Python运行
python3 sqlmap-gui.py
```

---

## 🧪 使用内置测试靶场

### 启动靶场服务器

所有用户都可以使用内置的SQL注入测试靶场进行练习。

#### Windows 用户

```cmd
# 方式一：双击启动
# 直接双击 start_test_server.bat

# 方式二：命令行启动
python test_sqli_server.py

# 要启用自动安装依赖，查看 start_test_server.bat 的内容
```

#### Linux/Mac 用户

```bash
# 方式一：使用启动脚本
bash start_test_server.sh

# 方式二：直接运行Python
python3 test_sqli_server.py

# 查看输出：
# Running on http://127.0.0.1:5000 (Press CTRL+C to quit)
```

### 访问靶场

启动后打开浏览器访问：

```
http://127.0.0.1:5000
```

### 测试关卡说明

#### GET请求注入（Less-1 ~ Less-10）

| 关卡    | URL               | 注入类型    | 说明                     |
| ------- | ----------------- | ----------- | ------------------------ |
| Less-1  | `/Less-1/?id=1`   | 单引号+报错 | 单引号闭合，返回错误信息 |
| Less-2  | `/Less-2/?id=1`   | 数字型+报错 | 直接数字注入，返回错误   |
| Less-3  | `/Less-3/?id=1)`  | 括号+报错   | 加括号闭合               |
| Less-4  | `/Less-4/?id=1"`  | 双引号+报错 | 双引号闭合               |
| Less-5  | `/Less-5/?id=1`   | 单引号+盲注 | 布尔型盲注（无错误信息） |
| Less-6  | `/Less-6/?id=1"`  | 双引号+盲注 | 布尔型盲注               |
| Less-7  | `/Less-7/?id=1`   | UNION注入   | 联合查询注入             |
| Less-8  | `/Less-8/?id=1`   | 时间盲注    | 基于时间延迟的盲注       |
| Less-9  | `/Less-9/?id=1`   | 堆叠注入    | 多语句执行               |
| Less-10 | `/Less-10/?id=1"` | 复合注入    | 混合型注入               |

**测试示例：**

```
基础访问：http://127.0.0.1:5000/Less-1/?id=1
注入测试：http://127.0.0.1:5000/Less-1/?id=1' or '1'='1
```

#### POST请求注入（Less-11 ~ Less-17）

| 关卡    | URL        | POST数据                 | 注入类型     |
| ------- | ---------- | ------------------------ | ------------ |
| Less-11 | `/Less-11` | uname=admin&passwd=admin | POST单引号   |
| Less-12 | `/Less-12` | uname=admin&passwd=admin | POST双引号   |
| Less-13 | `/Less-13` | uname=admin&passwd=admin | POST括号     |
| Less-14 | `/Less-14` | uname=admin&passwd=admin | POST数字型   |
| Less-15 | `/Less-15` | uname=admin&passwd=admin | POST盲注     |
| Less-16 | `/Less-16` | uname=admin&passwd=admin | POST时间盲注 |
| Less-17 | `/Less-17` | uname=admin&passwd=admin | POST错误注入 |

**测试方法：**

1. 在GUI中选择"POST数据包模式"
2. 在HTTP Request中输入：

   ```http
   POST /Less-11 HTTP/1.1
   Host: 127.0.0.1:5000
   Content-Type: application/x-www-form-urlencoded

   uname=admin&passwd=admin
   ```

#### Header注入（Less-18 ~ Less-21）

| 关卡    | URL        | Header          | 说明               |
| ------- | ---------- | --------------- | ------------------ |
| Less-18 | `/Less-18` | User-Agent      | User-Agent字段注入 |
| Less-19 | `/Less-19` | Referer         | Referrer字段注入   |
| Less-20 | `/Less-20` | Cookie          | Cookie字段注入     |
| Less-21 | `/Less-21` | X-Forwarded-For | IP头注入           |

**测试示例（使用GUI高级选项）：**

```
URL: http://127.0.0.1:5000/Less-18
自定义头部：
User-Agent: Mozilla/5.0' and '1'='1
Referer: http://google.com' OR '1'='1'
Cookie: id=1'; DROP TABLE users; --
```

---

## 🎯 GUI 使用指南

### 主界面布局

```
┌─────────────────────────────────────────────┐
│ SQLMap GUI V1.x - 图形化SQL注入扫描工具    │
├────────────┬─────────────────────┬──────────┤
│            │                     │          │
│  左侧面板   │    中部面板         │ 右侧面板 │
│  (选项配置) │   (URL和输出)       │ (高级)  │
│            │                     │          │
└────────────┴─────────────────────┴──────────┘
```

### 基本操作流程

#### 第一步：填写目标信息

**方法一：使用快速靶场**

1. 找到"快速靶场"下拉框
2. 点击选择一个预设的靶场
3. URL自动填入

**方法二：手动输入URL**

1. 在URL输入框中输入目标URL
2. 示例：`http://127.0.0.1:5000/Less-1/?id=1`

**方法三：导入HTTP数据包**

1. 点击"导入数据包"按钮
2. 选择保存的HTTP请求文件
3. 系统自动解析URL和POST数据

#### 第二步：配置扫描参数

**基础选项（推荐先配置）：**

| 参数         | 说明                    | 建议                   |
| ------------ | ----------------------- | ---------------------- |
| **测试级别** | 1-5，越高越全面但耗时长 | 首先用1，失败后用3或5  |
| **风险级别** | 1-3，越高可能损伤系统   | 测试环境用3，生产用1   |
| **线程数**   | 1-20，并发扫描数量      | 普通网络用5，高速用10+ |
| **超时时间** | 秒，单个请求超时        | 普通用10，慢速网络用30 |

**快速配置套餐：**

```
【快速扫描】（耗时最短，最不容易被检测）
  测试级别：1
  风险级别：1
  线程数：3
  勾选：获取当前数据库、获取当前用户

【标准扫描】（平衡耗时和成功率）
  测试级别：3
  风险级别：2
  线程数：5
  勾选：上述+枚举数据库、枚举表名

【全量扫描】（最全面，但耗时最长）
  测试级别：5
  风险级别：3
  线程数：10
  勾选：所有选项
```

#### 第三步：选择扫描动作

在中间偏右的"扫描选项"区域勾选要执行的操作：

**信息探测（推荐首先执行）：**

- ☑️ 获取当前数据库
- ☑️ 获取当前用户
- ☑️ 检查DBA权限

**数据库枚举：**

- ☑️ 枚举所有数据库
- ☑️ 枚举表名
- ☑️ 枚举列名
- ☑️ 枚举用户

**数据导出：**

- ☑️ 导出数据（需指定表和列）
- ☑️ 一键脱库（无需指定，导出全部）

#### 第四步：点击开始扫描

1. 确认以上配置无误
2. 点击"开始扫描"按钮
3. 在中部面板观看实时输出
4. 扫描结果会自动保存

#### 第五步：查看结果

**实时查看：**

- 中间面板自动显示扫描过程和结果
- 发现漏洞会自动高亮显示

**保存结果：**

- 点击"导出结果"保存为文件
- 支持TXT、CSV、JSON格式

---

## 🔧 高级功能

### 代理配置

**适用场景：**

- 需要匿名访问
- 远程扫描时规避ISP限制
- 通过公司代理访问外网

**配置步骤：**

1. 点击"高级选项"标签页
2. 在"代理设置"中输入代理地址
   ```
   HTTP：http://proxy.company.com:8080
   HTTPS：https://proxy.company.com:8080
   SOCKS5：socks5://127.0.0.1:1080
   ```
3. 如需认证，输入用户名和密码
4. 点击"测试代理"验证连接

### 注入技术选择

**可选技术：**

- **B** - 布尔型盲注（基于True/False判断）
- **E** - 基于错误的注入（返回数据库错误）
- **U** - UNION联合查询（显示注入）
- **S** - 堆叠注入（多语句执行）
- **T** - 基于时间的盲注（Sleep延迟）
- **Q** - 推理注入（逻辑推理）

**选择建议：**

```
不确定注入类型：全选（让sqlmap自动检测）
目标明确已知：只选该类型（加速扫描）
有WAF防护：选择B、T（不易被检测）
```

### 数据库类型指定

如果已知数据库类型，指定可以加速检测：

```
MySQL - 最常见的Web数据库
PostgreSQL - Linux服务器常用
MSSQL - Windows服务器、企业应用
Oracle - 大型企业数据库
SQLite - 嵌入式应用、移动应用
```

### 批量扫描

#### 批量URL模式

```
1. 在URL输入框中输入多个URL，每行一个：
   http://target1.com/page.php?id=1
   http://target2.com/search.php?id=1
   http://target3.com/view.php?id=1

2. 勾选"批量扫描"复选框

3. 点击"开始扫描"

4. 系统会依次扫描每个URL，生成单独的报告
```

#### 批量数据包模式

```
1. 在项目目录下创建 batch/ 文件夹

2. 在 batch/ 中放入多个HTTP请求文件：
   batch/
   ├── request1.txt
   ├── request2.txt
   └── request3.txt

3. 文件格式示例（request1.txt）：
   POST /login.php HTTP/1.1
   Host: target.com
   Content-Type: application/x-www-form-urlencoded

   username=admin&password=123123

4. 点击"导入数据包"

5. 勾选"批量扫描"，点击"开始"
```

### 配置保存与加载

**保存当前配置：**

```
1. 配置好所有参数后
2. 点击"保存配置"按钮
3. 输入配置名称（如 mysql_prod_scan）
4. 配置自动保存到本地
```

**加载已保存配置：**

```
1. 点击"加载配置"按钮
2. 选择要加载的配置
3. 所有参数自动填充
4. 可立即开始扫描或修改后扫描
```

---

## 💡 实用技巧

### 快速诊断注入点

```
第1步：检查基础信息
  URL: http://target.com/page.php?id=1
  设置：级别1、风险1、只勾选"获取当前数据库"
  目的：验证注入点是否存在

第2步：如果成功，执行完整扫描
  勾选所有需要的扫描选项
  提升级别和风险（如果需要）

第3步：优化扫描
  根据结果调整线程数和超时时间
```

### 处理防护措施

**遇到WAF（防火墙）时：**

```
1. 在高级选项中，勾选"使用Tamper脚本"
2. 选择合适的绕过脚本：
   - space2comment.py - 用注释替换空格
   - charencode.py - 字符编码绕过
   - base64encode.py - Base64编码绕过
   - 等等...
3. 重新扫描

配置示例：
  Tamper脚本: space2comment.py, charencode.py
```

### 加速扫描

```
【快速扫描技巧】
1. 降低级别：从5降到1
2. 降低风险：从3降到1
3. 只选必要扫描：不做完整枚举
4. 增加线程数：设置为15-20
5. 减少超时：改为5秒
```

### 隐蔽扫描

```
【规避流量分析】
1. 启用代理
2. 勾选"随机User-Agent"
3. 使用Tamper脚本
4. 增加请求间隔：高级 → 请求间隔
5. 降低线程数：2-3为最佳隐蔽配置
```

---

## 📊 输出结果说明

### 扫描完成后

**输出信息包含：**

```
[*] 测试参数：GET /page.php?id=1
[*] 测试水位: 3
[*] 目标数据库: MySQL 5.7.31
[*] 当前用户: root@localhost
[+] 数据库列表: information_schema, mysql, sqlmap_test, wordpress
[+] MySQL版本: 5.7.31-0ubuntu0.18.04.1
[!] 发现SQL注入漏洞: id参数存在UNION注入
[>] 导出表数据中...
```

### 文件输出

扫描完成后会在 `output/` 目录下生成：

```
output/
├── report_2026-02-19_14-30-45.txt      # 文本报告
├── dump/
│   ├── database_name/
│   │   ├── table1.csv
│   │   ├── table2.csv
│   │   └── ...
│   └── ...
└── log.json  # JSON格式的详细日志
```

---

## 🚨 常见错误解决

### 错误1："URL连接超时"

```
症状：扫描时卡住或提示超时
原因：网络问题或目标不存在
解决：
  1. 检查URL是否正确
  2. 在浏览器中访问URL，确保可访问
  3. 增加超时时间：改为30秒
  4. 尝试添加代理
```

### 错误2："未找到sqlmap.py"

```
症状：启动时提示找不到sqlmap
解决：
  1. 确保sqlmap-gui.py和sqlmap.py在同一目录
  2. 检查文件是否被删除
  3. 重新下载项目
```

### 错误3："无注入漏洞"

```
症状：扫描完成但未发现漏洞
原因：
  1. URL确实没有SQL注入
  2. 注入点已被WAF过滤
  3. sqlmap未识别出注入点

尝试：
  1. 增加测试级别到5
  2. 增加风险等级到3
  3. 增加线程数
  4. 使用Tamper脚本
  5. 检查URL参数拼写
```

---

## 📝 使用示例

### 示例1：快速检测本地测试库

```bash
# 步骤
1. 启动靶场：start_test_server.bat
2. 启动GUI：start_gui.bat
3. 在URL框输入：http://127.0.0.1:5000/Less-1/?id=1
4. 级别：1，风险：1，线程：5
5. 勾选：获取当前数据库、获取当前用户
6. 点击"开始扫描"

# 预期结果（2-5秒完成）
[+] 测试数据库: ctf
[+] 当前用户: root@localhost
```

### 示例2：完整的漏洞评估

```bash
# 适用于有足够时间的深度测试

1. URL: http://vulnapp.test/search.php?key=test
2. 配置：
   - 级别：5
   - 风险：2
   - 线程：10
   - 超时：15秒
3. 勾选所有扫描选项
4. 点击扫描（预计耗时10-20分钟）
5. 结果会自动保存到output文件夹
```

### 示例3：规避WAF扫描

```bash
1. URL: http://target.com/product.php?id=1

2. 高级配置：
   - 使用代理：true
   - Tamper脚本：space2comment.py, charencode.py
   - 随机User-Agent：true
   - 请求间隔：2秒
   - 线程数：2（低并发）

3. 级别：3，风险：1

4. 开始扫描
```

---

## 📞 获取帮助

如遇到问题，请按照以下步骤：

1. **查看本文档** - 大多数问题都有解决方案
2. **查看错误日志** - 控制台输出通常包含错误信息
3. **联系作者**：
   - 邮箱：1073723512@qq.com
   - 问题描述要尽可能详细

---

**祝您使用愉快！如有建议，欢迎反馈。** 🎉
